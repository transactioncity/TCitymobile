<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <title>ECOM - HTML Mobile Template</title>
	
	<!-- font Raleway link -->  
	<link href='https://fonts.googleapis.com/css?family=Open+Sans:400,600,700' rel='stylesheet' type='text/css'>
	<link href='https://fonts.googleapis.com/css?family=Roboto+Slab:400,300,700' rel='stylesheet' type='text/css'>
	
	<!-- all css here -->
    <!-- Path to Framework7 Library CSS-->
    <link rel="stylesheet" href="css/framework7.ios.min.css">
    <link rel="stylesheet" href="css/framework7.ios.colors.min.css">
    <link rel="stylesheet" href="css/swipebox.css">		        
	<!-- font-awesome.min CSS -->      
	<link rel="stylesheet" href="css/font-awesome.min.css">
	<!-- style CSS -->          
	<link rel="stylesheet" href="css/style.css">
	<!-- style CSS -->          
	<link rel="stylesheet" href="css/responsive.css">
  </head>
  <body>
    <!-- Status bar overlay for fullscreen mode-->
    <div class="statusbar-overlay"></div>
    <!-- Panels overlay-->
    <div class="panel-overlay"></div>
    <!-- Left panel with reveal effect-->
    <div class="panel panel-left panel-reveal menubg">
    	<div class="menu-hoverlay">
			<div class="line"></div>
			<div class="logo-box">
				<h3><img src="img/logo2.png" alt="" /></h3>
			</div>
			<div class="mainmenu">
				<div class="row">
				<div class="col-50">
						<div class="menu">
						<a class="item-link close-panel" href="#" OnClick="parse_url('myaccount.html');">
							<img src="img/menu/menu1/4.png" alt="">
							MY ACCOUNT
							</a>
						</div>
					</div>
					<div class="col-50">
						<div class="menu">
						<a class="item-link close-panel item-content" href="#" OnClick="parse_url('add_product.html');">
							<img src="img/menu/menu1/5.png" alt="">
							<span style="text-align: left;"> POST PRODUCT </span></a>
						</div>
					</div>
					<div class="col-50">
						<div class="menu">
						<a class="item-link close-panel item-content" href="#" OnClick="parse_url('myorders.html');">
							<img src="img/menu/menu1/5.png" alt="">
							TRANSACTIONS</a>
						</div>
					</div>
					
					<div class="col-50">
						<div class="menu" >
						<a class="item-link close-panel item-content" href="#" OnClick="parse_url('shop-here.html');">
							<img src="img/menu/menu1/6.png" alt="">
							STORE</a>
						</div>
					</div>
					
					<div class="col-50">
						<div class="menu">
						<a class="item-link close-panel item-content" href="#" OnClick="parse_url('shopping-cart.html');">
							<img src="img/menu/menu1/8.png" alt="">
							MY CART</a>
						</div>
					</div>
					<div class="col-50">
						<div class="menu">
						<a class="item-link close-panel item-content" href="#" OnClick="parse_url('checkout.html');">
							<img src="img/menu/menu1/9.png" alt="">
							CHECKOUT</a>
						</div>
					</div>				
					
					<div class="col-50">
						<div class="menu">
						<a class="item-link close-panel item-content external" href="tel:+88-01627-600206">
							<img src="img/menu/menu1/2.png" alt="">
							BROWSE</a>
						</div>
					</div>
					<div class="col-50">
						<div class="menu">
						<a class="item-link close-panel item-content"href="#" OnClick="parse_url('logout.html');">
							<img src="img/menu/menu1/3.png" alt="">
							LOGOUT</a>
						</div>
					</div>		
				</div>
			</div>
			<!-- Menu end -->
		</div>
    </div>
	
	
 <!-- Views-->
    <div class="views">
      <!-- Your main view, should have "view-main" class-->
		<div class="view view-main">
				<!-- Top Navbar-->
<!-- We don't need full layout here, because this page will be parsed with Ajax-->
<!-- Top Navbar-->
<div class="navbar">
  <div class="navbar-inner">
   
	<div class="left">
				  <!-- left link contains only icon - additional "icon-only" class--><a href="#" class="link icon-only open-panel"><img src="img/menu.png" alt=""></a>
					</div>
					<!-- We have home navbar without left link-->
					<div class="center sliding"><script type="text/javascript" src='https://cdn.datatables.net/1.10.12/js/dataTables.bootstrap.min.js'></script>
<script type="text/javascript" src='https://cdn.datatables.net/1.10.12/js/dataTables.bootstrap.min.js'></script>
<script type="text/javascript" src='https://cdn.datatables.net/1.10.12/js/dataTables.bootstrap.min.js'></script><span style="color: #335e93;font-weight: bold;font-family: 'Open Sans', sans-serif; "> TransactionCity </span></div>
						<div class="right">
				
				
				<ul style="margin-right:10px">
							<li class="account_cart" ><a href="" onClick="parse_url('shopping-cart.html');"><img style="margin-top: 5px;background-color: #ffffff"    src="img/cart-top.png"   style="width:30px;height:30px;cursor:pointer;position: relative;"> </a>  </li>
							<!-- 
							-->


							<span id="current_cart_count">0</span>



							</ul>
					</div>
				
  </div>
</div>
<div class="pages">
  <!-- Page, data-page contains page name-->
  <div data-page="portfolio" class="page">
    <!-- Scrollable page content-->
    <div class="page-content">
      <div class="content-block">
        <div class="content-block-inner">
        <div class="contact-form">
          <input type="hidden" name="token" id="token"  value="Qw234OpI90"/>
		 
											
												
			    First Name 

				<input  style="margin-top: 10px"  type="text" name="firstname" id="firstname" placeholder="First Name"><br>
				
		
				Last Name 
				<input  style="margin-top: 10px"  type="text" name="lastname" id="lastname" placeholder="Last Name"><br>
				User Name 
				<input  style="margin-top: 10px"  type="text" name="username" id="username" placeholder="User Name"><br>
				Password 
				<div class="row" style="margin-top: 10px"> 

				<div  class="col-lg-10" style="width:800px;">

				 <input readonly value="*********"></input> </div>

				<div class="col-lg-2">


				<button type="button" name="password" id="password" class="mybutton pull-right" style="margin-bottom: 10px"> Edit</button></div></div>
			
				Email
				<input style="margin-top: 10px" type="text" name="email" id="email" placeholder="Email"/><br>
				<span id="address1">
				<h1>Primary Address</h1>
				
				Contact Name
				<input  style="margin-top: 10px"  type="text" name="contactname" id="contactname1" placeholder="Contact Name"/><br>
				Phone Number
				<input style="margin-top: 10px"   type="text" name="phonenumber" id="phonenumber1" placeholder="Phone Number"/><br>
				Country
				<select  name="country" id="country1" style="height:40px;width:100%;margin-top: 10px;margin-bottom: 10px">
				</select>
			
				State
				<input style="margin-top: 10px"  type="text" name="state" id="state1" placeholder="State"/><br>
				City
				<input style="margin-top: 10px"  type="text" name="city" id="city1" placeholder="City"/><br>
				Street
				<input style="margin-top: 10px"  type="text" name="street" id="street1" placeholder="Street"/><br>
				Post Code
				<input style="margin-top: 10px"  type="text" name="postcode" id="postcode1" placeholder="Post Code"/><br>
				Website
				<input  style="margin-top: 10px"  type="text" name="website" id="website1" placeholder="Website"/><br>
				</span>
				<span id="address1">
				<h1>Secondary Address</h1>
				
				Contact Name
				<input style="margin-top: 10px"  type="text" name="contactname" id="contactname2" placeholder="Contact Name"/><br>
				Phone Number
				<input  style="margin-top: 10px"  type="text" name="phonenumber" id="phonenumber2" placeholder="Phone Number"/><br>
				Country
				<select  name="country" id="country2" style="height:40px;width:100%;margin-top: 10px;margin-bottom: 10px" >
				</select> 
				State
				<input style="margin-top: 10px"  type="text" name="state" id="state2" placeholder="State"/><br>
				City
				<input style="margin-top: 10px"  type="text" name="city" id="city2" placeholder="City"/><br>
				Street
				<input style="margin-top: 10px"  type="text" name="street" id="street2" placeholder="Street"/><br>
				Post Code
				<input style="margin-top: 10px"  type="text" name="postcode" id="postcode2" placeholder="Post Code"/><br>
				Website
				<input style="margin-top: 10px"  type="text" name="website" id="website2" placeholder="Website"/><br>
				</span>
				
				
				Photo : <br>
				<input style="border:none;margin-top: 10px;margin-bottom: 10px" type="file" name="photo" id="photo" /> 
				
					
				
				
				
				
			
			
				
				<div class="item-content inputbox">
				  <div class="item-inner"> 
					<div class="item-input">
					  <button OnClick="Save_user();" class="mybutton button-big">Save User</button>
					</div>
				  </div>
				</div>
			
		
            
         
           
            
           
           
            
           
           
            </div>
           
            
            </div>
            </div>
           
           
         

        </div>
      </div>
    </div>
  </div>
</div>
  </div>
</div>
<div class="modal" id='modal'>
  <div class="modal-inner">
         <div class="modal-title"></div>
               <div class="modal-text"</div>
                   </div>
     <div class="modal-buttons">
            <span class="modal-button modal-button-bold"></span>
         </div>
  </div>            
<!-- Js -->
	<!-- jquery-1.11.3.min js -->         
	<script src="js/jquery-1.11.3.min.js"></script>
	<!-- Path to Framework7 Library JS --> 
    <script type="text/javascript" src="js/framework7.min.js"></script>
    <!--jquery.swipebox js --> 
    <script type="text/javascript" src="js/jquery.swipebox.js"></script>
	<!-- Path to your app js --> 
    <script type="text/javascript" src="js/my-app.js"></script>
	
	 
		<script type="text/javascript">
		var cartcount=window.localStorage["cart"];
		     
		     $("#current_cart_count").html(cartcount);
		var htm="";
		 $.get("http://www.transactioncity.com/stagingnew/content/Auth/fetch_countries.php",
   
    function(data, status){
   	 htm+="<option value=''>Select Country</option>"
	    var obj = JSON.parse(data);
	    $.each(obj,function(key,val){
	    	htm+="<option value="+val.name+">"+val.name+"</option>";
	    	})
	    $("#country1").html(htm);
	    $("#country2").html(htm);
	    
	   
  });
		var myApp = new Framework7();
 
var $$ = Dom7;
 
$$('#password').on('click', function () {
	 myApp.modal({
    title:  'Change Password',
    afterText:'<label>Current Password<label><input type="password" name="oldpassword" id="oldpassword"><br>'+
    		  '<label>New Password<label><input type="password" name="newpassword" id="newpassword"><br>'+
    		  '<label>Confirm Password<label><input type="password" name="cnpassword" id="cnpassword"><br><span ="color:red" id="msg"></span>'	,
    buttons: [
      {
        text: 'Ok',
        onClick: function() {
          var oldpassword=$('#oldpassword').val();	
          var newpassword=$('#newpassword').val();
          var cnpassword=$('#cnpassword').val();
          var token = $('#token').val(); 
          if(newpassword==cnpassword)
          {
          		 $.post("http://transactioncity.com/stagingnew/content/Auth/change_pass.php",
				    {
				        newpassword:newpassword,
				        oldpassword:oldpassword,
				        token:token,
				        user_id:window.localStorage["id"]
						
				    },
				    function(data, status){
					
					    if(data==1)
					    {
					    	myApp.alert('Password Changed');
					    }
					    else if(data==0)
					    {
					    	myApp.alert('Please Enter Correct Old Password');
					    }
				    });
					
          }
         else
         {
					    	myApp.alert('Please Enter Correct Confirm Password');

         }

   
	
        }
      },
      {
        text: 'Cancel',
        onClick: function() {
          
        }
      }
    ]
  })
});
 

function get_user_details()
{
	 


 var user_id = window.localStorage["id"];

var token = $('#token').val();  	
	 $.post("http://www.transactioncity.com/stagingnew/content/Auth/get_user_details.php",
    {
     user_id:user_id,
	 token:token
    },
    function(data, status){
   	 
	    var dataxx = JSON.parse(data);
	    /*console.log(dataxx);*/
		$('#firstname').val(dataxx.firstname);

 $('#lastname').val(dataxx.lastname);
 $('#username').val(dataxx.username);
 /*$('#password').val(dataxx.password);*/
  $('#email').val(dataxx.email);
  


console.log(dataxx.address[0])
  window.localStorage['currency']=dataxx.address[0].currency_code;
   $('#state1').val(dataxx.address[0].state);
$('#city1').val(dataxx.address[0].city);
 $('#contactname1').val(dataxx.address[0].contactname);
$('#phonenumber1').val(dataxx.address[0].phonenumber);
 $('#country1').val(dataxx.address[0].country);
$('#street1').val(dataxx.address[0].street);
$('#postcode1').val(dataxx.address[0].postcode);
$('#website1').val(dataxx.address[0].website);

if(dataxx.address[1])
{
   $('#state2').val(dataxx.address[1].state);
$('#city2').val(dataxx.address[1].city);
 $('#contactname2').val(dataxx.address[1].contactname);
$('#phonenumber2').val(dataxx.address[1].phonenumber);
 $('#country2').val(dataxx.address[1].country);
$('#street2').val(dataxx.address[1].street);
$('#postcode2').val(dataxx.address[1].postcode);
$('#website2').val(dataxx.address[1].website);
}

    });
	
	
	
}
		
		
			$(document).ready(function(){
	
	var user = window.localStorage["username"];
	
	
	
	if(user=="" || !user)
	{
	document.location.href='index.html';
	}
	else
	{

 get_user_details();
   }
});
	
		
		
function parse_url(val)
{
document.location.href= val;

}

function Save_user()
{
 var file_data = $('#photo').prop('files')[0];   
  var form_data = new FormData();                  
  form_data.append('file', file_data);
  var user_id = window.localStorage["id"];


 var token = $('#token').val();  

 var firstname = $('#firstname').val();

  var lastname = $('#lastname').val();
  var username = $('#username').val();
  var email = $('#email').val();
 
 
 var state = $('#state1').val();
var city = $('#city1').val();
var contactname = $('#contactname1').val();
var phonenumber = $('#phonenumber1').val();
var country = $('#country1').val();
var street = $('#street1').val();
var postcode = $('#postcode1').val();
var website = $('#website1').val();

 var state2 = $('#state2').val();
var city2 = $('#city2').val();
var contactname2 = $('#contactname2').val();
var phonenumber2 = $('#phonenumber2').val();
var country2 = $('#country2').val();
var street2 = $('#street2').val();
var postcode2 = $('#postcode2').val();
var website2 = $('#website2').val();


  
  form_data.append('token', token); 
  form_data.append('firstname', firstname); 
  form_data.append('lastname', lastname); 
  form_data.append('username', username); 
  form_data.append('email', email); 
  form_data.append('id', user_id);
  
  
 form_data.append('state', state); 
  form_data.append('city', city); 
  form_data.append('contactname', contactname); 
  form_data.append('phonenumber', phonenumber); 
   form_data.append('country', country); 
  form_data.append('street', street); 
 form_data.append('postcode', postcode); 
  form_data.append('website', website);

   form_data.append('state2', state2); 
  form_data.append('city2', city2); 
  form_data.append('contactname2', contactname2); 
  form_data.append('phonenumber2', phonenumber2); 
   form_data.append('country2', country2); 
  form_data.append('street2', street2); 
 form_data.append('postcode2', postcode2); 
  form_data.append('website2', website2);
 
	   $.ajax({
                url: 'http://www.transactioncity.com/stagingnew/content/Auth/update_user.php', // point to server-side PHP script 
                dataType: 'text',  // what to expect back from the PHP script, if anything
                cache: false,
                contentType: false,
                processData: false,
                data: form_data,                         
                type: 'post',
                success: function(data){
				if(data==1)
				{
				
				var dataxx= "Succesfully Updated the user";
				myApp.alert(dataxx); 
				get_user_details()
				}
				else
				{
				
				var dataxx= "Could not Update the user";
				myApp.alert(dataxx); 
				}
                  
                }
     });
		
}





</script>